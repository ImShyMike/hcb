<% style = card_shipping_map_url(stripe_card) ?
            "background: linear-gradient(to bottom, rgba(20, 20, 20, 0.75), rgba(0, 0, 9, 0.5)), url(#{card_shipping_map_url(stripe_card)}); height: 250px"
            : "" %>

<div class="card p0 flex flex-column justify-between" style="<%= style %>">
  <h3 class="border-none m0 p2">
    Card for
    <% if @event %>
      <%= user_mention stripe_card.user %>
    <% else %>
      <%= link_to stripe_card.event.name, stripe_card.event %>
    <% end %>
    is on the way!
  </h3>
  <% if stripe_card.shipping_has_tracking? %>
    <section class="mb1 flex items-center">
      <p>
        <strong>Carrier</strong>
        <%= stripe_card.stripe_obj&.shipping&.carrier&.capitalize %>
      </p>
      <p>
        <strong>ETA</strong>
        <%= format_date Time.at(stripe_card.stripe_obj&.shipping&.eta).to_date %>
      </p>
      <p>
        <strong>Tracking #</strong>
        <%= link_to stripe_card.stripe_obj&.shipping&.tracking_url do %>
          <%= stripe_card.stripe_obj&.shipping&.tracking_number %>
        <% end %>
      </p>
    </section>
  <% else %>
    <section class="pl2 mb2 text-shadow-lg flex flex-column" style="gap: 8px;">
      <%= render_address OpenStruct.new(stripe_card.attributes.transform_keys { |key| key.gsub(/^stripe_shipping_/, "") }) %>
      <% eta = stripe_card.stripe_obj&.shipping&.eta %>
      <span>
        <% if eta %>
          Estimated to arrive <%= format_date Time.at(stripe_card.stripe_obj&.shipping&.eta).to_date %>.
        <% else %>
          No estimated arrival date at this time.
        <% end %>
      </span>
    </section>
  <% end %>
</div>
