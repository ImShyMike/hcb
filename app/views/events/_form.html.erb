<%= form_with(model: event, local: true, class: 'mb3') do |form| %>
  <%= form_errors event, 'account info' %>

  <div class="field">
    <label class="bold">Plan</label>
    <p class="mt0"><%= event.name %> is on the <strong><%= event.plan_name %></strong> plan.</p>
  </div>

  <% if !event.is_spend_only %>
    <div class="field">
      <label class="bold">Fee</label>
      <p class="mt0">Bank is charging <%= event.sponsorship_fee.blank? ? "" : event.sponsorship_fee * 100 %>% of your revenue</p>
    </div>
  <% end %>

  <div class="field">
    <%= form.label :address, class: 'bold' %>
    <%= form.text_area :address, value: event.address || '42 Placeholder Ave.' %>
  </div>

  <% if !@event.is_spend_only %>
    <h3 class="mb1">Donations</h3>

    <div class="field field--checkbox">
      <%= form.check_box :donation_page_enabled %>
      <%= form.label :donation_page_enabled, "Enable donation page" %>
    </div>
    <% if event.donation_page_enabled %>
      <div class="field">
        <%= form.label :donation_page_message, "Message to show on donation page" %>
        <%= form.text_area :donation_page_message %>
      </div>
      <%= link_to 'Click here to go to your donations page', start_donation_donations_path(event.slug) %>
    <% end %>
  <% end %>


  <% if current_user.events.size > 1 && event.persisted?%>
    <div class="field field--checkbox">
      <%= form.check_box :hidden, checked: event.hidden_at.present? %>
      <%= form.label :hidden, "Hide #{event.name} from home page for everyone" %>
    </div>
  <% end %>

  <h3 class="mb1">Danger Zone</h3>
  <div class="card border b--warning mb3">
    <div class="flex items-center warning">
      <%= inline_icon 'important', size: 32, class: 'mr1' %>
      <p class="bold mt0 mb0">If you change your URL, beware:</p>
    </div>
    <ul class="mt1 mb2">
      <li>Another project may claim your current URL and you could be <span class="bold">unable to get it back</span></li>
      <li>All bookmarks to this eventâ€™s Bank will <span class="bold">break</span></li>
      <li>Your team members currently using Bank will be bumped to the home page</li>
    </ul>   
    <%= form.label :slug, 'Bank URL', class: 'bold' %> 
    <div class="flex items-center">
      <span class="slate">bank.hackclub.com/</span>
      <%= form.text_field :slug, placeholder: event.persisted? ? event.name.parameterize : nil %>
    </div>
  </div>

  <% admin_tools do %>
    <div class="field">
      <%= form.label :name, 'Name (if changed, also change across G Suite & Emburse)' %>
      <%= form.text_field :name %>
    </div>

    <div class="field">
      <%= form.label :start %>
      <%= form.date_select :start %>
    </div>

    <div class="field">
      <%= form.label :end %>
      <%= form.date_select :end %>
    </div>

    <div class="field">
      <%= form.label :sponsorship_fee, "Sponsorship fee (as fraction of revenue)" %>
      <%= form.text_field :sponsorship_fee, value: event.sponsorship_fee || 0.07, placeholder: '0.07' %>
    </div>

    <div class="field">
      <%= form.label :emburse_department_id %>
      <%= form.text_field :emburse_department_id %>
    </div>

    <div class="field">
      <%= form.label :point_of_contact_id %>
      <%= form.collection_select :point_of_contact_id, User.admin.all, :id, :email %>
    </div>

    <div class="field field--checkbox">
      <%= form.check_box :has_fiscal_sponsorship_document %>
      <%= form.label :has_fiscal_sponsorship_document, 'Display Fiscal Sponsorship Confirmation in Documents tab?' %>
    </div>

    <div class="field field--checkbox">
      <%= form.check_box :is_spend_only %>
      <%= form.label :is_spend_only, 'Make this a spend-only account?' %>
    </div>

    <div class="field field--checkbox">
      <%= form.check_box :beta_features_enabled %>
      <%= form.label :beta_features_enabled, 'Turn on beta (features in development) for this event?' %>
    </div>
  <% end %>

  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>
