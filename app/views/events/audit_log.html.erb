<%= turbo_frame_tag :audit_log do %>
  <ul class="list-reset">
    <% @event.versions.select { |version| version.changeset.present? }.map do |version| %>
      <li>
        <div><%= user_mention User.find(version.whodunnit) %> <%= version.event %>d <span class="muted tooltipped tooltipped--n" style="cursor: default" aria-label="<%= version.created_at.strftime("%b %e, %Y") %>"><%= time_ago_in_words version.created_at %> ago</span></div>
        <% if version.event == "update" %>
          <ul class="list-reset">
            <% version.changeset.excluding("updated_at").select { |field, changes| changes.any?(&:present?) }.each do |field, changes| %>
              <li><%= field.humanize %>: <span class="primary"><%= humanize_audit_log_value(field, changes[0]) %></span> â†’ <span class="success"><%= humanize_audit_log_value(field, changes[1]) %></span></li>
            <% end %>
          </ul>
        <% end %>
      </li>
      <hr class="mt1 mb1">
    <% end %>
  </ul>
<% end %>
