<% if @activities.length > 0 %>
<div class="card card--breakdown shadow-none flex-1 flex flex-col p-0" style="height: <%= [(@cards.length + 1.5) * 45, 320].max %>px">
  <div class="flex items-center pb-2 p-4 mt-auto justify-between">
    <h3 class="m-0">Recent activity</h3>
    <%= link_to event_transactions_path(event_id: @event.slug), class: "flex items-center" do %>
      See all
      <%= inline_icon "enter" %>
    <% end %>
  </div>

  <% if @activities.none? %>
    <p class="m-0 p-4 pt-2 pb-0 mb-1">
      <i class="muted">Nothing has happened recently.</i>
    </p>
  <% end %>
  <ul class="list-reset comments w-100 my-0 pb-2 overflow-y-scroll p-4 pt-1">
    <%= turbo_stream_from current_user, @event, "activities" %>
    <turbo-frame id="activities-<%= @activities.current_page %>" target="_top">
      <%= render_activities(@activities.reject { |activity| activity.trackable.nil? && !activity.trackable_is_deletable? }) %>
      <% if @activities.next_page %>
        <%= turbo_frame_tag(
              "activities-#{@activities.next_page}",
              loading: :lazy,
              src: "/#{@event.slug}/settings/audit_log?page=#{@activities.next_page}",
              target: "_top"
            ) do %>
          <i class="muted block text-center">Loading more activities...</i>
        <% end %>
      <% end %>
    </turbo-frame>
  </ul>

</div>
<% else %>
  <div class="card card--breakdown shadow-none p-0 text-center flex-1 flex flex-col items-center justify-center" style="height: <%= [(@cards.length + 1.5) * 45, 320].max %>px">
    <h3 class="m-0 p-4 pb-0 max-w-xs">
      It's quiet here...
    </h3>
    <p class="m-0 p-4 pt-2 pb-0 mb-1 muted max-w-xs">
      Here's where you'll see recent activity from your team.
    </p>
  </div>
<% end %>
