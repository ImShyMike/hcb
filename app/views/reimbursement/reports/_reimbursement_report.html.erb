<a class="text-decoration-none" href="<%= !show_mock_data? ? (local_assigns[:href] || reimbursement_report_path(reimbursement_report)) : "javascript:;" %>">
  <div class="stripe-card virtual active" style="background-image: radial-gradient(ellipse at top left, #<%= "%06x" % Random.new(reimbursement_report.id).rand(0..0x888888) %>, transparent);" data-behavior="hover_tilt">
    <% items = (reimbursement_report.versions.select { |version| version.changeset.any? { |field, changes| changes.any?(&:present?) } } + policy_scope(reimbursement_report.comments)).sort_by(&:created_at) %>
    <% changes_requested = false %>
    <% items.each do |item| %>
      <% if item.is_a?(Comment) %>
        <% changes_requested = item.changes_requested? %>
      <% elsif changes_requested && item.changeset["aasm_state"]&.last == "submitted" %>
        <% changes_requested = false %>
      <% end %>
    <% end %>
    <span class="absolute ml2 badge h4 stripe-card__status bg-<%= changes_requested ? "warning" : reimbursement_report.status_color %>" style="right: 0; top: 0; margin-right: 1.5rem; margin-top: 1rem;">

      <%= changes_requested ? "Changes Requested" : reimbursement_report.status_text %>
    </span>
    <p class="absolute m0 h3 bold brand-sans" style="left: 0; margin-right: 3.5rem; margin-left: 1.5rem; margin-top: 1.5rem;">
      Reimbursement for:<br>
      <span style="font-weight: normal; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis;"><%= reimbursement_report.name %></span>
    </p>
    <p class="absolute m0 h3 bold brand-sans" style="left: 0; bottom: 0; margin-right: 3.5rem; margin-left: 1.5rem; margin-bottom: 3rem;">
      You're requesting:
      <span class="pt1" style="font-weight: normal;">$<%= render_money_amount reimbursement_report.amount_cents %></span>
    </p>
    <p class="absolute m0 h4 brand-sans" style="left: 0; bottom: 0; margin-right: 3.5rem; margin-left: 1.5rem; margin-bottom: 1rem; opacity: 50%;">
      Click to <%= reimbursement_report.draft? ? "edit" : "view" %>
    </p>
  </div>
</a>
