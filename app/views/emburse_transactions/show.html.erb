<% if @card %>
  <% title "#{render_money @emburse_transaction.amount.abs} #{@emburse_transaction.amount > 0 ? 'credited from' : 'spent at' } #{@emburse_transaction.merchant_name}" %>
<% else %>
  <% title "Transfer of #{render_money @emburse_transaction.amount}" %>
<% end %>
<% page_sm %>
<%= render 'events/nav' if @event %>

<% if @card %>
  <%# if we don't limit width of the card, it looks weird
    on larger screens %>
  <div style="max-width: 400px; margin: 0 auto">
    <%= render 'cards/card', card: @card %>
  </div>
<% end %>

<article class="card max-width-2 mx-auto mt3">
  <section class="mb2">
    <h2 class="mt0 mb0 heading">
      <% if @card %>
        <span class="flex-auto mb1"><%= "#{render_money @emburse_transaction.amount.abs} #{@emburse_transaction.amount > 0 ? 'credited from' : 'spent at' } #{@emburse_transaction.merchant_name}" %></span>
      <% else %>
        <span class="flex-auto mb1">Transfer of <%= render_money @emburse_transaction.amount %></span>
      <% end %>
      <span class="badge h4 md-right ml0 mb1 bg-<%= @emburse_transaction.status_badge_type %>">
        <%= @emburse_transaction.status_text %>
      </span>
    </h2>

    <section class="details">
      <p>
        <strong>Amount <%= @emburse_transaction.amount > 0 ? 'credited' : 'spent' %></strong>
        <%= render_money @emburse_transaction.amount.abs %>
      </p>

      <% if @card %>
        <p>
          <strong>Category</strong>
          <%= @emburse_transaction.category_name.nil? ? "Uncategorized" : @emburse_transaction.category_name %>
        </p>

        <p>
          <strong>Spent by</strong>
          <% if @emburse_transaction.card.nil? %>
            -
          <% else %>
            <%= "#{@emburse_transaction.card.full_name}"%>
          <% end %>
        </p>

        <p>
          <strong>Receipt</strong>
          <% if @emburse_transaction.receipt_url %>
            <a href="<%= @emburse_transaction.receipt_url %>">See attachment</a>
          <% else %>
            Not uploaded yet
          <% end %>
        </p>
      <% end %>
    </section>

  </section>
</article>
