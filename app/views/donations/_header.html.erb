<% @has_header_image = @event.donation_header_image.attached? %>

<action
  role="button"
  data-behavior="toggle_theme"
  class="muted absolute top-0 right-0 m2 pointer no-select tooltipped tooltipped--w"
  aria-label="Toggle dark mode" tabindex="0">
  <%= inline_icon 'moon', size: home_action_size %>
  <%= inline_icon 'moon-fill', size: home_action_size, style: 'display: none;' %>
</action>

<% if organizer_signed_in? && Flipper.enabled?(:donation_page_customization_2022_06_29, @event) %>
  <div class="flex items-center m2 absolute top-0 left-0">
    <%= form_with model: @event, data: { "controller" => "submit-form" } do |form| %>
      <%= form.file_field :donation_header_image, required: true, class: "display-none", data: { action: "change->submit-form#submit" } %>
      <%= form.label :donation_header_image do %>
        <div
          role="button"
          class="muted pointer no-select tooltipped tooltipped--e line-height-0"
          aria-label="<%= @has_header_image ? "Edit" : "Upload" %> header image">
          <%= inline_icon 'photo', size: home_action_size %>
        </div>
      <% end %>
    <% end %>
    <% if @has_header_image %>
      <%= link_to event_remove_header_image_path(@event), method: :post do %>
        <div
          role="button"
          class="muted pointer ml1 no-select tooltipped tooltipped--e line-height-0"
          aria-label="Remove header image">
          <%= inline_icon 'view-close', size: home_action_size %>
        </div>
      <% end %>
    <% else %>
      <span class="badge bg-success">New!</span>
    <% end %>
  </div>
<% end %>

<% if @has_header_image %>
  <div class="donations-header-image" style="background-image: url('<%= url_for @event.donation_header_image %>'); ">
    <div class="donations-header-image__overlay"></div>
  </div>
<% end %>

<a href="<%= start_donation_donations_path(@event.slug) %>" class="black text-decoration-none">
  <h1 class="mt4 mb2 border-none center <%= "smoke" if @has_header_image %>" style="<%= "margin-top: 100px" if @has_header_image %>">
    <span class="h3 caps block <%= @has_header_image ? "muted" : "secondary" %>">Donate to</span>
    <span><%= @event.name %></span>
  </h1>
</a>
