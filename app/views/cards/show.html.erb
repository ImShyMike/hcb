<%= link_to @card.event.name, event_path(@card.event), class: 'breadcrumb' %>
<h1 class="heading">
  Card for <%= @card.user.email %>
  <%= link_to 'See Balance', @card.emburse_path, target: '_blank', class: 'btn bg-accent' %>
  <%= link_to 'Edit', edit_card_path(@card), class: 'btn bg-info' if admin_signed_in? %>
</h1>

<section class="details">
<p>
  <strong>Email address</strong>
  <%= @card.user.email %>
</p>

<p>
  <strong>Card number</strong>
  XXXX-XXXX-XXXX-<%= @card.last_four %>
</p>

<% if admin_signed_in? %>
<p>
  <strong>Total budget</strong>
  <%= render_money @card.total_budget %>
</p>
<% end %>
</section>

<h2 class="heading">
  Load requests
  <%= link_to 'Request to Add Money', new_event_load_card_request_path(event_id: @card.event.id), class: 'btn bg-success' %>
</h2>
<% if @card.load_card_requests.any? %>
  <ul class="list list--row list--unlinked my0">
    <% @card.load_card_requests.each do |request| %>
      <li>
        <p class="flex-auto">
          <%= status_badge request.status_badge_type %>
          <strong><%= render_money request.load_amount %> – <%= request.status %>
          <%= "– ID##{request.id}" if admin_signed_in? %></strong>
          <span class="muted">(added by <%= request.creator.email %> <span title="<%= request.created_at %>"><%= time_ago_in_words request.created_at %> ago</span>)</span>
        </p>
        <%= link_to 'Cancel',
          event_load_card_request_cancel_path(
            load_card_request_id: request.id,
            event_id: request.event.id),
          method: :post,
          class: 'btn btn--destroy' if request.under_review? %>
      </li>
    <% end %>
  </ul>
<% else %>
  <%= blankslate 'No load card requests' %>
<% end %>
