> _Note: The details in this guide rely on [PR #5028](https://github.com/hackclub/hcb/pull/5028), which at the moment is not merged._

As an easy to use money thing, it's a little hard to get real data in development unless you use production data (which isn't the best solution). Fortunately, with a little help from admin tools and the Rails console, most things can be faked so that you can test new code. This guide specifically deals with faking transactions.

## Step 1: Generate the transaction
The way HCB works is that there are a bunch of transaction sources, each with their own raw data. Transactions from all sources are then aggregated into a canonical transaction, which contains all the basic information, and most importantly, a link back to the raw source. Since it's useful to have transactions from many sources, what we'll do is use an easy method to generate a canonical transaction and its associated data (such as an HCB code), and then if needed convert it to another source.

### Method A: Fake donations
The easiest method to generate a transaction is by faking a donation. To enable fake donations, you'll first need to enable the feature in Flipper. Go to `http://<host>/flipper`, and add a new feature named `fake_donations_2024_01_21`. Enable the feature. Then, go to the donations page for the event you want, and put in some dummy data. For the payment steps, use card number 4242 4242 4242 4242, expiration date as any future date, and a 3-digit number for CVC. Finally, just submit and you're done! The donation should now show up on that event's ledger.

### Method B: Generic fake transactions
If you don't want to fake a donation, there's also another method to make a new transaction. However, it's a little more involved.

First, go to `http://<host>/admin/raw_transactions`, and create a new raw transaction. Go into your browser's developer tools by right clicking on the dropdown menu for "Bank Identifier", and inside that select element, add the following element:
```html
<option selected="selected" value="FSMAIN">FSMAIN</option>
```
Fill out the rest of the field on the page, and then submit.

Next, enter the rails console. This is usually `bin/rails c`, but if you're using Docker, you may need to run that command inside of the `hcb-web` container. Run the following commands:
```ruby
::TransactionEngine::HashedTransactionService::RawCsvTransaction::Import.new.run
::TransactionEngine::CanonicalTransactionService::Import::All.new.run
```
Now for the last step! Go to `http://<host>/admin/ledger` and map the transaction to the event you want. You should now see a generic "Bank account transaction" in the ledger!

If all you need is any transaction, you're done. If you need it from a different source, such as a Stripe card, continue to Step 2.

## Step 2: Link to the source
For this step, a Stripe card source will be used as an example. However, the steps should be more or less the same for any source.

First, create a database row for the source model you need and assign it to a variable. In this case, it's a RawStripeTransaction, so run this:
```ruby
st = RawStripeTransaction::new()
```
Fill in the fields that you need. At the minimum you need everything that's marked as non-null (you can see the schema in the model file). Note that `id`, `created_at`, and `updated_at` are generated by Rails when you save. Once you've done that, save it with the `save` method.

Next, find the canonical transaction that you made in Step 1, and assign it to a variable. You'll only need to update two fields: `transaction_source_type` and `transaction_source_id`. `transaction_source_type` will be the name of the source model, and `transaction_source_id` the `id` field of the source row you just created and saved. Once you've done that, you can save this as well - PaperTrail may ask you for a email to log, so enter the email of your user.

And that's it! Depending on the source you need, you'll need to enter different data (such as a cardholder ID for Stripe card transactions), but this will get you started.